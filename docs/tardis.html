<!DOCTYPE html>  <html> <head>   <title>tardis.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               tardis.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <pre><code>Tardis.js 0.0.1
(c) 2013 Stephen Belanger, Opzi Inc.
Tardis may be freely distributed under the MIT license.
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Node.js</h2>

<p><strong>Tardis</strong> works with node.js! It doesn't use module.exports, as it doesn't
export anything. It only modifies the global Date and Number objects.
To use it, simply add <code>require('tardis')</code> at the top of your file and all
this neat stuff will just work automatically!</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>Date</h2>

<p>First of all, <strong>Tardis</strong> hacks up the Date object prototype to make it more
flexible, and provides some expressive helpers for common manipulations.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h3>Class methods</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>You can create standard Date objects from a simple hash containing <code>years</code>,
<code>months</code>, <code>days</code>, <code>hours</code>, <code>minutes</code>, <code>seconds</code>, and <code>milliseconds</code> as keys,
matched to simple number values.</p>

<p><strong>NOTE</strong>: For any key not provided, the current time value will be used.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <h3>Serialization</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Any date object can be converted to a simple hash description, which can be
used with <code>create</code> to build a new date object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toObject</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">years</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">months</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">days</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">hours</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">minutes</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">seconds</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getSeconds</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">milliseconds</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getMilliseconds</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>You can also easily clone existing date objects, so you can manipulate
them without potentially breaking whatever other code supplied the object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">clone</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toObject</span><span class="p">())</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h3>Movement</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>You can use <code>to</code> if you want to jump to a particular point in time.
Any keys left blank will be filled in with the current time, so you can
make jumps of varying specificity.</p>

<p>For example;</p>

<pre><code>// Wait a minute, Doc. Are you telling me that it's 8:25?
timestamp.to({ minutes: 0 })
</code></pre>

<p><strong>NOTE</strong>: This is destructive to the base object!</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">to</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">isFinite</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">years</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setFullYear</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">years</span><span class="p">)</span>
  <span class="nb">isFinite</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">months</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">months</span><span class="p">)</span>
  <span class="nb">isFinite</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">days</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">days</span><span class="p">)</span>
  <span class="nb">isFinite</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hours</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hours</span><span class="p">)</span>
  <span class="nb">isFinite</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">minutes</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setMinutes</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">minutes</span><span class="p">)</span>
  <span class="nb">isFinite</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">seconds</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setSeconds</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">seconds</span><span class="p">)</span>
  <span class="nb">isFinite</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">milliseconds</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setMilliseconds</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">milliseconds</span><span class="p">)</span>
  <span class="k">return</span> <span class="k">this</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>You can also use <code>move</code> with positive or negative values to adjust the
current time up or down relative to the current value of the date object.</p>

<p>For example;</p>

<pre><code>// Bill Murray used this one alot.
timestamp.move({ days: -1 })
</code></pre>

<p><strong>NOTE</strong>: This is destructive to the base object!</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">to</span><span class="p">({</span>
    <span class="nx">years</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">years</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">months</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">months</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">days</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">days</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">hours</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hours</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">minutes</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">minutes</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">seconds</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getSeconds</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">seconds</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">milliseconds</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getMilliseconds</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">milliseconds</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <h3>Getter Flags</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>You can also use a variety of getter flags to make many common manipulations
more expressive. All getters are non-destructive, so you can use them safely
without messing with the source object and potentially breaking other code
that may access it.</p>

<p>You can get the <code>yesterday</code> or <code>tomorrow</code> of a particular point in time.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;yesterday&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">clone</span><span class="p">().</span><span class="nx">move</span><span class="p">({</span> <span class="nx">days</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">})</span>
<span class="p">})</span>
<span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;tomorrow&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">clone</span><span class="p">().</span><span class="nx">move</span><span class="p">({</span> <span class="nx">days</span><span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
<span class="p">})</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Or you could jump to the <code>start</code> or <code>end</code> of a day.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">clone</span><span class="p">().</span><span class="nx">to</span><span class="p">({</span> <span class="nx">hours</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">minutes</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">seconds</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">milliseconds</span><span class="o">:</span> <span class="mi">0</span> <span class="p">})</span>
<span class="p">})</span>
<span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">.</span><span class="nx">move</span><span class="p">({</span> <span class="nx">hours</span><span class="o">:</span> <span class="mi">24</span><span class="p">,</span> <span class="nx">milliseconds</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">})</span>
<span class="p">})</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>You can even jump to some common points such as <code>noon</code> or <code>midnight</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;noon&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">.</span><span class="nx">move</span><span class="p">({</span> <span class="nx">hours</span><span class="o">:</span> <span class="mi">12</span> <span class="p">})</span>
<span class="p">})</span>
<span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;midnight&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">end</span>
<span class="p">})</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h3>UTC Timestamps</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>If you need a UTC adjusted timestamp, that's easy enough too.</p>

<p>You can use <code>toUTCObject</code> to grab a hash representation of the current date
object with UTC adjustments applied.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toUTCObject</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">years</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUTCFullYear</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">months</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUTCMonth</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">days</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUTCDate</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">hours</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUTCHours</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">minutes</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUTCMinutes</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">seconds</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUTCSeconds</span><span class="p">()</span>
    <span class="p">,</span> <span class="nx">milliseconds</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUTCMilliseconds</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Or you can use the <code>utc</code> flag to create a copy of the current date object
with the UTC adjustments applied.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">clone</span><span class="p">().</span><span class="nx">to</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toUTCObject</span><span class="p">())</span>
<span class="p">})</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <h2>Number</h2>

<p>Now for some super-cool hacks to the number prototype for generating dates.
It's good practice to wrap numbers in parenthesis, as Javascript interprets
the first dot as a decimal point, so you need two for property access.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <h3>Step size flags</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>We can use these step size flags to expressively construct date objects.
All the step size flags can be used in both singular and plural form.</p>

<p>For example;</p>

<pre><code>(1).year.ago
(2).months.ago
(3).days.ago
(4).hours.ago
(5).minutes.ago
(6).seconds.ago
(7).milliseconds.ago
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">flags</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;minute&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">,</span> <span class="s1">&#39;millisecond&#39;</span>
  <span class="p">]</span>
  <span class="p">,</span> <span class="nx">flag_error</span> <span class="o">=</span> <span class="s1">&#39;Use a step flag (&#39;</span> <span class="o">+</span> <span class="nx">flags</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;(s), &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;(s)) first&#39;</span>

<span class="nx">flags</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">mode</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">plural</span> <span class="o">=</span> <span class="nx">mode</span> <span class="o">+</span> <span class="s1">&#39;s&#39;</span>

  <span class="kd">function</span> <span class="nx">getter</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span><span class="p">[</span><span class="nx">plural</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span>
  <span class="p">}</span>

  <span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="nx">mode</span><span class="p">,</span> <span class="nx">getter</span><span class="p">)</span>
  <span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="nx">plural</span><span class="p">,</span> <span class="nx">getter</span><span class="p">)</span>
<span class="p">})</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <h3>Direction flags</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>We can use <code>before</code> and <code>after</code> flags to specify whether to move into the
future or into the past with our date construction. We can also use <code>from</code>
as an alias of <code>after</code> for more understandable wording in some cases.</p>

<p>For example;</p>

<pre><code>(1).year.before.now
(2).days.after.now
(3).minutes.from.now
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">directionHandler</span> <span class="p">(</span><span class="nx">mode</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">before</span> <span class="o">=</span> <span class="nx">mode</span> <span class="o">==</span> <span class="s1">&#39;before&#39;</span>
  <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">flag_error</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">mode</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span><span class="p">[</span><span class="nx">mode</span><span class="p">]</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span><span class="p">.</span><span class="nx">before</span> <span class="o">==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">value</span><span class="p">.</span><span class="nx">before</span> <span class="o">=</span> <span class="nx">before</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;after&#39;</span><span class="p">,</span> <span class="nx">directionHandler</span><span class="p">(</span><span class="s1">&#39;after&#39;</span><span class="p">))</span>
<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="nx">directionHandler</span><span class="p">(</span><span class="s1">&#39;before&#39;</span><span class="p">))</span>
<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">after</span> <span class="p">})</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <h3>Origin Flags</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Lastly, we need some flags to specify the origin point to adjust from to
construct the final date object. The most obvious flag is <code>now</code>, though
you can also use some other common words such as <code>yesterday</code>, <code>today</code>,
<code>tomorrow</code>, <code>midnight</code> or <code>noon</code>.</p>

<p>For the sake of clarity, there is also <code>ago</code> as an alias of <code>before.now</code>.</p>

<p>For example;</p>

<pre><code>(1).day.after.tomorrow
(2).days.before.yesterday
(3).hours.before.midnight
(4).minutes.ago
(5).seconds.after.noon
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;now&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;You haven\&#39;t built a valid date definition yet&#39;</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">mode</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span><span class="p">[</span><span class="nx">mode</span><span class="p">]</span>
    <span class="nx">result</span><span class="p">[</span><span class="nx">mode</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">before</span> <span class="o">&amp;&amp;</span> <span class="o">-</span><span class="nx">value</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="nx">value</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">).</span><span class="nx">move</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
<span class="p">})</span>

<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;yesterday&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="p">.</span><span class="nx">yesterday</span> <span class="p">})</span>
<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;today&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">now</span> <span class="p">})</span>
<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;tomorrow&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="p">.</span><span class="nx">tomorrow</span> <span class="p">})</span>
<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;midnight&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="p">.</span><span class="nx">midnight</span> <span class="p">})</span>
<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;ago&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">before</span><span class="p">.</span><span class="nx">now</span> <span class="p">})</span>
<span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;noon&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="p">.</span><span class="nx">noon</span> <span class="p">})</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <h3>Chaining</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>And to save the best for last; you can even chain manipulations with <code>and</code>!</p>

<p>For example;</p>

<pre><code>(5).minutes.and(30).seconds.from.now
(1).year.before.and(1).day.after.now
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">and</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">new_val</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">this</span><span class="p">.</span><span class="nx">date_obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;You haven\&#39;t built a valid date definition yet&#39;</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">new_val</span> <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span>
<span class="p">};</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 